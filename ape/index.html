<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> Ape |  Tianxiao Gu</title>


    <!-- Styles -->
    <link href="/css/fontawesome-all.css" rel="stylesheet" type="text/css"><!-- font-awesome -->
    <link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css"><!-- Bootstrap -->
    <link href="/css/pygments.css" rel="stylesheet" type="text/css"><!-- Pygments -->
    <link href="/css/moon.css" rel="stylesheet" type="text/css"><!-- moon -->
    <link href="/css/bibtex.css" rel="stylesheet" type="text/css"><!-- bibtex-->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <!--
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-51393322-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-51393322-1');
    </script>
    -->
  </head>
  <body role="document">
    <div class="container">
    <h1 id="ape-automated-testing-of-android-applications-with-abstraction-refinement">Ape: Automated Testing of Android Applications with Abstraction Refinement</h1>
<p><a href="/ape-bin.zip">Download</a></p>
<h2 id="publication">Publication</h2>
<p>Ape applies a CEGAR style technique to refine and coarsen the model abstraction.
A paper about Ape's main idea has been accepted to ICSE 2019.</p>
<ul class="bibtex">

<li><a name="gu_practical_2019"></a>

<div><span class="bibtex title">Practical GUI Testing of Android Applications via Model Abstraction and Refinement</span>, </span></div>
<div><span class="bibtex author">Tianxiao Gu, Chengnian Sun, Xiaoxing Ma, Chun Cao, Chang Xu, Yuan Yao, Qirun Zhang, Jian Lu, and Zhendong Su, 
</span></div>
<div>
<span class="bibtex pages">in </span><span class="bibtex booktitle">Proceedings of the 41st ACM/IEEE International Conference on Software Engineering (ICSE 2019)</span>
<span>, </span>
<span class="bibtex pages">to appear, </span>
<span class="bibtex year">2019.</span>



</div>
</li>

</ul>

<h3 id="evaluation">Evaluation</h3>
<ul>
<li>Crashes detected by Ape using only 15 minutes.<ul>
<li><a href="https://ape-report.github.io/">list1</a></li>
<li><a href="https://ape-report.github.io/ape-report-1">list2</a></li>
</ul>
</li>
<li><a href="./reported-bugs">Reported bugs</a></li>
</ul>
<p>In the ICSE paper, we evaluated Ape in two experiments.</p>
<ul>
<li>The first part of the evaluation was conducted on x86 emulators.<ul>
<li><a href="./install-google-play-store-in-an-emulator">Install the Google Play Store in an Emulator</a>.<ul>
<li>We need to download x86 compatible apps.</li>
</ul>
</li>
<li>Install <a href="#minitracing">Mini Tracing</a>.<ul>
<li>This step can be omitted if you do not want to collect method and instruction coverage.</li>
</ul>
</li>
<li>Login with a test google account.<ul>
<li>This step can be omitted if you do not want to test the Google Drive app.</li>
</ul>
</li>
<li>Install and test the following packages for one hour.<ul>
<li><a href="https://play.google.com/store/apps/details?id=com.citymapper.app.release"><code>com.citymapper.app.release</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=com.duolingo"><code>com.duolingo</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=com.enzuredigital.weatherbomb"><code>com.enzuredigital.weatherbomb</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=com.google.android.apps.docs"><code>com.google.android.apps.docs</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=com.google.android.apps.translate"><code>com.google.android.apps.translate</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=com.nuzzel.android"><code>com.nuzzel.android</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=com.popularapp.thirtydayfitnesschallenge"><code>com.popularapp.thirtydayfitnesschallenge</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=com.zillow.android.zillowmap"><code>com.zillow.android.zillowmap</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=flipboard.app"><code>flipboard.app</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=org.videolan.vlc"><code>org.videolan.vlc</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=tunein.player"><code>tunein.player</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=com.amaze.filemanager"><code>com.amaze.filemanager</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=com.eleybourn.bookcatalogue"><code>com.eleybourn.bookcatalogue</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=org.liberty.android.fantastischmemo"><code>org.liberty.android.fantastischmemo</code></a></li>
<li><a href="https://play.google.com/store/apps/details?id=org.totschnig.myexpenses"><code>org.totschnig.myexpenses</code></a></li>
</ul>
</li>
</ul>
</li>
<li>The second part of the evaluation requires a huge amount of time. We release all stack traces instead.<ul>
<li><a href="./trace.zip">Stack traces (537 in total)</a></li>
</ul>
</li>
</ul>
<p><a name="minitracing"></a></p>
<h3 id="mini-tracing">Mini Tracing</h3>
<p>We provided a <code>libart.so</code> for x86 emulators to collect coverage without instrumentation.
That means, you can use this tool to collect coverage for apps such as Google Doc to evaluate your tools.</p>
<ul>
<li>MiniTracing: Collect method/coverage without bytecode instrumentation.<ul>
<li><a href="/art-mt-x86.zip">Android 6 (binary for x86)</a>: Android ART with method/instruction coverage support.</li>
<li><a href="/dalvikvm-mt-x86.zip">Android 4.4 (binary for x86)</a>: Android Dalvik VM with method/instruction coverage support.</li>
<li><a href="https://bitbucket.org/txgu/android-mt-cmd">android-mt-cmd</a>: Command line tools to collect coverage.</li>
<li><a href="https://bitbucket.org/txgu/android-mt-parser">android-mt-parser</a>: Parser for the coverage data.</li>
</ul>
</li>
</ul>
<h2 id="install">Install</h2>
<p>Files inside <code>ape-bin.zip</code>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>ape-bin/
ape-bin/ape
ape-bin/ape.jar
ape-bin/ape.py
ape-bin/install.py
ape-bin/README.md
</pre></div>
</td></tr></table>

<p>Copy Just copy the <code>ape.jar</code> to the phone.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>adb push ape.jar /data/local/tmp/
</pre></div>
</td></tr></table>

<p>and run</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>adb shell CLASSPATH=/data/local/tmp/ape.jar /system/bin/app_process /data/local/tmp/ com.android.commands.monkey.Monkey
</pre></div>
</td></tr></table>

<p>More details can be found in <code>README.md</code>.</p>
<h2 id="run">Run</h2>
<p>We provide a python script (i.e., <code>ape.py</code>) to facilitate running ape on Android platform.</p>
<p>The following command starts to run Ape to test the Calculator on a real device connected via <code>adb</code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>./ape.py -p com.google.android.calculator --running-minutes 100 --ape sata
</pre></div>
</td></tr></table>

<p>Check the <code>ape.py</code> if you want to run Ape with an emulator.
You should at least remove the <code>-d</code> options for <code>adb</code>.</p>
<p>Options:</p>
<ul>
<li><code>-p</code>: specify the package name, the same as Monkey</li>
<li><code>--running-minutes</code>: the total testing time in minutes<ul>
<li>This is the continuous mode, which means Ape does not stop when it triggers a crash.</li>
</ul>
</li>
<li><code>--ape sata</code>: use the default exploration strategy described in the paper.<ul>
<li><del>You can also try <code>orbit</code>, <code>wechat</code>, <code>random</code>, and reinforcement learning enhanced random (<code>satarl</code>)</del></li>
<li>Only <code>random</code> and <code>ape</code> are supported now.</li>
</ul>
</li>
</ul>
<p>You can also specify the total amount of Monkey events. In this mode, Ape will stop by default once there is a crash.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>./ape.py -p com.google.android.calculator --ape sata 1000
</pre></div>
</td></tr></table>

<h2 id="visualization">Visualization</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Screenshot is disabled by default to save space.</p>
</div>
<p>We provide a tool to visualize the model.</p>
<ol>
<li>Ape writes several js files into the output folder for visualization.<ul>
<li>Check the tail of the output message to locate the output folder in the phone.</li>
</ul>
</li>
<li><code>adb pull /sdcard/your-output-folder</code> to your local directory.</li>
<li>Copy the following files into the local output directory<ul>
<li><a href="./demo/vis.html">vis.html</a> (Right click and choose 'save as')</li>
<li><a href="./demo/vis.min.css">vis.min.css</a></li>
<li><a href="./demo/vis.min.js">vis.min.js</a></li>
</ul>
</li>
<li>Open the copied <code>vis.html</code> in your browser.<ul>
<li>You may need to wait for a certain amount of time to let the browser render the model.</li>
</ul>
</li>
</ol>
<p>Examples:</p>
<ul>
<li><a href="./demo/vis.html">Calculator</a></li>
<li><a href="./demo-mtxx/vis.html">Meitu</a> (1 min).</li>
</ul>
<p>Now we can check the timeline.</p>
<ul>
<li><a href="./demo-keep-timeline/vis.html">Google Keep</a><ul>
<li><a href="./demo-keep-timeline/vis-timeline.html">Timeline</a></li>
<li>Copy <a href="./demo-keep-timeline/vis-timeline.html">vis-timeline.html</a> to your local output directory.</li>
<li>Open the copied <code>vis-timeline.html</code> in your browser.</li>
</ul>
</li>
</ul>
<h2 id="acknowledgments">Acknowledgments</h2>
<p>We thank the following experts for their insightful comments on Ape.</p>
<ul>
<li><a href="https://tingsu.github.io/">Ting Su</a></li>
<li>Zhao Zhang 张钊</li>
</ul>
    </div>

    <footer class="footer" style="margin-top:50px;">
      <div class="container">
          <span class="text-muted">&copy; 2017 <a href="/">Tianxiao Gu</a>. All rights reserved.</span>
      <!--
      -->
      <div style="width:70px;height:48px;">
      <script type='text/javascript' id='clustrmaps' src='//cdn.clustrmaps.com/map_v2.js?cl=ffffff&w=70&t=n&d=I1T5oEaSW-FJIJ_bZCvK8XMDQ35ouGHQP_ixsLYwvOo'></script></div>
      </div>
    </footer>

    <!-- jQuery -->
    <script src="/js/jquery-3.2.1.min.js"></script>
    <script src="/js/jquery-migrate-1.4.1.min.js"></script>
    <!-- Bootstrap -->
    <script src="/js/bootstrap.min.js"></script>

    

    

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-51393322-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-51393322-1');
    </script>

  </body>
</html>